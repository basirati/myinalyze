{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
</head>
<body id="page-top">
	<div style="width: 100%; display: table;">
		<div style="display: table-row; background: #7CC1AC;">
			<div style="display: table-cell;">
				<label>Number of Requirements:</label><label>450</label><br>
			</div>
			<div style="display: table-cell;">
				<label>Dependency Type</label><br>
				<input type="checkbox" name="Constrains" value="constrains" checked>Constrains<br>
				<input type="checkbox" name="Contradicts" value="contradicts">Contradicts<br>
			</div>
			<div style="display: table-cell;">
				<label>Visualization Type</label>
				<select>
					<option value="table">Table</option>
					<option value="cluster">Cluster</option>
					<option value="individual">Individual</option>
				</select>
			</div>
		</div>

		<div style="display: table-row; background: #7CC1AC;">
			<div style="display: table-cell;">
				<label>Most Dependent:</label><label>bla bla bla</label><br>
				<label>Most Depending:</label><label>bla bla bla</label><br>
			</div>
			<div style="display: table-cell;">
				<label>Most Independent:</label><label>bla bla bla</label><br>
				<label>Least Influential:</label><label>bla bla bla</label><br>
			</div>
			<div style="display: table-cell;">
				<label>Search:</label>
				<input type="text" name="search_key">
			</div>
		</div>
	</div>

	<div>
		<button id="checkbtn">start</button>
	</div>

	<p id="test">{{content}}</p>
	<p >most ingoing degree {{rgraph.max_indeg_value}}: {{rgraph.max_indeg}}</p>
	<p >least ingoing degree {{rgraph.min_indeg_value}}: {{rgraph.min_indeg}}</p>
	
	{% if deps %}
	<ul>
		{% for d in deps %}
		<li>{{ d }}</li>
		{% endfor %}
	</ul>
	{% else %}
	<p>NO REQS ARE AVAILABLE.</p>
	{% endif %}

	{% if reqs %}
	<ul id='myreqs' style="display: none;">
		{% for r in reqs %}
		<li>{{ r }}</li>
		{% endfor %}
	</ul>
	{% else %}
	<p>NO REQS ARE AVAILABLE.</p>
	{% endif %}

	<script src="{% static "riaapp/vendor/jquery/jquery.min.js" %}"></script>

	{% block javascript %}
	<script>
		function makeNodes() {
			var lis = document.getElementById("myreqs").getElementsByTagName("li");
			var nodes=[];
			for (var i = 0; i < lis.length; i++) {
				nodes.push(lis[i].innerHTML);
			}
			return nodes;
		}
		
		$('#checkbtn').click(function() {
			$.get('/riaapp/getreqs/', {}, function(data){
				nodes = [];
      			for (var i = 0; i < data.jreqs.length; i++) {
        			nodes.push({name: data.jreqs[i], id: i+1});
      			}
      			links = [];
      			for (var i = 0; i < data.jdeps.length; i++) {
        			s = data.jdeps[i].source;
        			d = data.jdeps[i].destination;
        			si = -1; di = -1;
        			for (var j = 0; j < nodes.length; j++) {
          				if (nodes[j].name == s)
          					si = nodes[j].id
          				if (nodes[j].name == d)
          					di = nodes[j].id
          				if (si > -1 && di > -1)
          					break;
          			}
          			links.push({source: si, target: di, type: "constrains"});
        		}
        		console.log(nodes);
        		console.log(links);
			});
		});
	</script>
	{% endblock %}
</body>
</html>